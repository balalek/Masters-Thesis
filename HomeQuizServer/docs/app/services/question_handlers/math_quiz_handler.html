<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
<meta name="generator" content="pdoc3 0.11.6">
<title>app.services.question_handlers.math_quiz_handler API documentation</title>
<meta name="description" content="Handler for Math Quiz type questions in the quiz application.
Manages sequences of mathematical equations and their answers,
with specialized …">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/sanitize.min.css" integrity="sha512-y1dtMcuvtTMJc1yPgEqF0ZjQbhnc/bFhyvIyVNb9Zk5mIGtqVaAB1Ttl28su8AvFMOY0EwRbAe+HCLqj6W7/KA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/typography.min.css" integrity="sha512-Y1DYSb995BAfxobCkKepB1BqJJTPrOp3zPL74AWFugHHmmdcvO+C48WLrUOlhGMc0QG7AE3f7gmvvcrmX2fDoA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:1.5em;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:2em 0 .50em 0}h3{font-size:1.4em;margin:1.6em 0 .7em 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .2s ease-in-out}a:visited{color:#503}a:hover{color:#b62}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900;font-weight:bold}pre code{font-size:.8em;line-height:1.4em;padding:1em;display:block}code{background:#f3f3f3;font-family:"DejaVu Sans Mono",monospace;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source > summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible;min-width:max-content}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em 1em;margin:1em 0}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul ul{padding-left:1em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" integrity="sha512-D9gUyxqja7hBtkWpPWGt9wfbfaMGVt9gnyCvYa+jojwwPHLCzUm5i8rpk7vD7wNee9bA35eYIjobYPaQuKS1MQ==" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => {
hljs.configure({languages: ['bash', 'css', 'diff', 'graphql', 'ini', 'javascript', 'json', 'plaintext', 'python', 'python-repl', 'rust', 'shell', 'sql', 'typescript', 'xml', 'yaml']});
hljs.highlightAll();
/* Collapse source docstrings */
setTimeout(() => {
[...document.querySelectorAll('.hljs.language-python > .hljs-string')]
.filter(el => el.innerHTML.length > 200 && ['"""', "'''"].includes(el.innerHTML.substring(0, 3)))
.forEach(el => {
let d = document.createElement('details');
d.classList.add('hljs-string');
d.innerHTML = '<summary>"""</summary>' + el.innerHTML.substring(3);
el.replaceWith(d);
});
}, 100);
})</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>app.services.question_handlers.math_quiz_handler</code></h1>
</header>
<section id="section-intro">
<p>Handler for Math Quiz type questions in the quiz application.
Manages sequences of mathematical equations and their answers,
with specialized validation and formatting for math content.</p>
<p>Author: Bc. Martin Baláž</p>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="app.services.question_handlers.math_quiz_handler.MathQuizQuestionHandler"><code class="flex name class">
<span>class <span class="ident">MathQuizQuestionHandler</span></span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class MathQuizQuestionHandler(BaseQuestionHandler):
    &#34;&#34;&#34;
    Handler for Math Quiz type questions (sequences of equations).
    
    Processes questions containing multiple mathematical equations that
    players must solve in sequence. Each equation has its own answer and
    time limit. Includes specialized validation for numeric answers and
    handling for different formats of numeric input.
    &#34;&#34;&#34;
    
    def __init__(self):
        &#34;&#34;&#34;Initialize the handler with the MATH_QUIZ question type.&#34;&#34;&#34;
        super().__init__(QUESTION_TYPES[&#34;MATH_QUIZ&#34;])
    
    def validate(self, question_data: Dict[str, Any]) -&gt; bool:
        &#34;&#34;&#34;
        Validate that the math quiz question data is valid.
        
        Checks that:

        - The question contains sequences of equations
        - Each sequence has both an equation and a numeric answer
        - All answers are valid numbers
        
        Args:
            question_data: Raw question data to validate
            
        Returns:
            bool: True if the math quiz data is valid
        &#34;&#34;&#34;
        # Override base validation to skip question validation
        # Only verify type is correct
        if not question_data or question_data.get(&#39;type&#39;) != self.question_type:
            return False
        
        # Math Quiz specific validation
        sequences = question_data.get(&#39;sequences&#39;, [])
        
        # Check if sequences are present
        if not sequences or not isinstance(sequences, list):
            return False
            
        # Check if each sequence has valid equations and answers
        for sequence in sequences:
            if not sequence or not isinstance(sequence, dict):
                return False
                
            equation = sequence.get(&#39;equation&#39;)
            answer = sequence.get(&#39;answer&#39;)
            
            # Both equation and answer must be present
            if not equation or answer is None:
                return False
                
            # Answer must be a number (int or float)
            if not isinstance(answer, (int, float)) and not (
                isinstance(answer, str) and self._is_valid_number(answer)
            ):
                return False
                
        return True
    
    def add_type_specific_fields(self, question_data: Dict[str, Any]) -&gt; Dict[str, Any]:
        &#34;&#34;&#34;
        Process and normalize the math equations and answers.
        
        Processes each sequence to ensure:

        - All answers are properly formatted numbers
        - Each sequence has a time limit
        - Equations are properly formatted
        
        Args:
            question_data: Raw question data from frontend
            
        Returns:
            Dict: Dictionary with normalized math sequences
        &#34;&#34;&#34;
        # Process sequences with normalized answers and ensure each has a length
        sequences = []
        if question_data and isinstance(question_data.get(&#39;sequences&#39;), list):
            for sequence in question_data.get(&#39;sequences&#39;, []):
                if not sequence or not isinstance(sequence, dict):
                    continue
                    
                answer = sequence.get(&#39;answer&#39;)
                # Convert string answers to numbers
                if isinstance(answer, str):
                    answer = self._normalize_number(answer)
                    
                sequences.append({
                    &#39;equation&#39;: sequence.get(&#39;equation&#39;, &#39;&#39;),
                    &#39;answer&#39;: answer,
                    &#39;length&#39;: sequence.get(&#39;length&#39;, QUIZ_VALIDATION[&#34;TIME_LIMIT_DEFAULT_MATH&#34;])
                })
                
        return {
            &#34;sequences&#34;: sequences
        }
    
    def format_for_frontend(self, question: Dict[str, Any], quiz_name: str = &#34;Unknown Quiz&#34;) -&gt; Dict[str, Any]:
        &#34;&#34;&#34;
        Format math quiz question for frontend display.
        
        Creates a display-friendly version of the math quiz with:

        - Default title for math questions
        - Formatted sequence data
        - Human-readable answer display
        
        Args:
            question: Database question document
            quiz_name: Name of the parent quiz
            
        Returns:
            Dict: Formatted math quiz question for frontend display
        &#34;&#34;&#34;
        # Safety check to avoid NoneType errors
        if not question:
            return {
                &#39;_id&#39;: &#39;&#39;,
                &#39;question&#39;: &#39;Matematické rovnice&#39;,
                &#39;type&#39;: self.question_type,
                &#39;category&#39;: &#39;&#39;,
                &#39;length&#39;: &#39;&#39;,
                &#39;timeLimit&#39;: &#39;&#39;,
                &#39;quizName&#39;: quiz_name,
                &#39;timesPlayed&#39;: 0,
                &#39;copy_of&#39;: None,
                &#39;isMyQuestion&#39;: False,
                &#39;sequences&#39;: [],
                &#39;answers&#39;: [{&#39;text&#39;: &#39;No equations defined&#39;, &#39;isCorrect&#39;: True}]
            }
        
        # Customize the base implementation for math quiz questions that don&#39;t have a question field
        question_data = {
            &#39;_id&#39;: str(question.get(&#39;_id&#39;, &#39;&#39;)),
            &#39;question&#39;: &#39;Matematické rovnice&#39;,  # Default title for math sequences
            &#39;type&#39;: question.get(&#39;type&#39;, self.question_type),
            &#39;category&#39;: question.get(&#39;category&#39;, &#39;&#39;),
            &#39;length&#39;: question.get(&#39;length&#39;, &#39;&#39;),
            &#39;timeLimit&#39;: question.get(&#39;length&#39;, &#39;&#39;),
            &#39;quizName&#39;: quiz_name,
            &#39;timesPlayed&#39;: question.get(&#39;metadata&#39;, {}).get(&#39;timesUsed&#39;, 0) if question.get(&#39;metadata&#39;) else 0,
            &#39;copy_of&#39;: str(question[&#39;copy_of&#39;]) if question.get(&#39;copy_of&#39;) else None,
            &#39;isMyQuestion&#39;: False
        }
        
        sequences = question.get(&#39;sequences&#39;, [])
        # Ensure sequences is always a list
        if not isinstance(sequences, list):
            sequences = []
            
        question_data[&#39;sequences&#39;] = sequences
        
        # Format for display in the game
        # Create answers for display in existing questions dialog
        answers = []
        for sequence in sequences:
            if not sequence or not isinstance(sequence, dict):
                continue
                
            answers.append({
                &#39;text&#39;: f&#34;{sequence.get(&#39;equation&#39;, &#39;&#39;)} = {sequence.get(&#39;answer&#39;, &#39;&#39;)} ({sequence.get(&#39;length&#39;, QUIZ_VALIDATION[&#39;TIME_LIMIT_DEFAULT_MATH&#39;])}s)&#34;,
                &#39;isCorrect&#39;: True
            })
            
        if not answers:
            answers = [{&#39;text&#39;: &#39;No equations defined&#39;, &#39;isCorrect&#39;: True}]
            
        question_data[&#39;answers&#39;] = answers
            
        return question_data
    
    def create_question_dict(self, question_data: Dict[str, Any], quiz_id: ObjectId, 
                           device_id: str, original: Optional[Dict[str, Any]] = None) -&gt; Dict[str, Any]:
        &#34;&#34;&#34;
        Create a database document for a math quiz question.
        
        Adapts the base question structure for math quiz specifics:
        
        - Doesn&#39;t require standard question text
        - Stores sequences of equations
        - Handles metadata appropriately
        
        Args:
            question_data: Raw question data from frontend
            quiz_id: MongoDB ObjectId of the parent quiz
            device_id: Device identifier of the creator/editor
            original: Original question document if this is an update
            
        Returns:
            Dict: Processed math quiz question ready for database storage
        &#34;&#34;&#34;
        if not question_data:
            question_data = {&#39;sequences&#39;: []}
        
        is_modified = question_data.get(&#34;modified&#34;, False)
        is_existing = original is not None
        
        question_dict = {
            &#34;type&#34;: self.question_type,
            &#34;part_of&#34;: quiz_id,
            &#34;created_by&#34;: device_id,
            &#34;copy_of&#34;: self._determine_copy_of(question_data, original, is_modified, is_existing),
            &#34;metadata&#34;: QuestionMetadata().to_dict()
        }
        
        # Add type-specific fields
        question_dict.update(self.add_type_specific_fields(question_data))
        
        return question_dict

    def _is_valid_number(self, value: str) -&gt; bool:
        &#34;&#34;&#34;
        Check if a string represents a valid number.
        
        Supports both period (.) and comma (,) as decimal separators
        for international number formats.
        
        Args:
            value: String to check for numeric validity
            
        Returns:
            bool: True if the string represents a valid number
        &#34;&#34;&#34;
        # Safety check
        if not value or not isinstance(value, str):
            return False
            
        # Replace comma with dot for decimal numbers
        value = value.replace(&#39;,&#39;, &#39;.&#39;)
        try:
            float(value)
            return True
        
        except (ValueError, TypeError):
            return False
    
    def _normalize_number(self, value: str) -&gt; float:
        &#34;&#34;&#34;
        Convert string to a numeric value.
        
        Handles international number formats by supporting both
        period (.) and comma (,) as decimal separators. Attempts
        to convert to integer when possible, otherwise to float.
        
        Args:
            value: String representing a number
            
        Returns:
            int/float: The numeric value of the string, or 0.0 if invalid
        &#34;&#34;&#34;
        # Safety check
        if not value or not isinstance(value, str):
            return 0.0
            
        value = value.replace(&#39;,&#39;, &#39;.&#39;)
        try:
            # Convert to int if it&#39;s a whole number, otherwise float
            return int(value) if value.isdigit() else float(value)
        
        except (ValueError, TypeError):
            return 0.0</code></pre>
</details>
<div class="desc"><p>Handler for Math Quiz type questions (sequences of equations).</p>
<p>Processes questions containing multiple mathematical equations that
players must solve in sequence. Each equation has its own answer and
time limit. Includes specialized validation for numeric answers and
handling for different formats of numeric input.</p>
<p>Initialize the handler with the MATH_QUIZ question type.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="app.services.question_handlers.base_handler.BaseQuestionHandler" href="base_handler.html#app.services.question_handlers.base_handler.BaseQuestionHandler">BaseQuestionHandler</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="app.services.question_handlers.math_quiz_handler.MathQuizQuestionHandler.add_type_specific_fields"><code class="name flex">
<span>def <span class="ident">add_type_specific_fields</span></span>(<span>self, question_data: Dict[str, Any]) ‑> Dict[str, Any]</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_type_specific_fields(self, question_data: Dict[str, Any]) -&gt; Dict[str, Any]:
    &#34;&#34;&#34;
    Process and normalize the math equations and answers.
    
    Processes each sequence to ensure:

    - All answers are properly formatted numbers
    - Each sequence has a time limit
    - Equations are properly formatted
    
    Args:
        question_data: Raw question data from frontend
        
    Returns:
        Dict: Dictionary with normalized math sequences
    &#34;&#34;&#34;
    # Process sequences with normalized answers and ensure each has a length
    sequences = []
    if question_data and isinstance(question_data.get(&#39;sequences&#39;), list):
        for sequence in question_data.get(&#39;sequences&#39;, []):
            if not sequence or not isinstance(sequence, dict):
                continue
                
            answer = sequence.get(&#39;answer&#39;)
            # Convert string answers to numbers
            if isinstance(answer, str):
                answer = self._normalize_number(answer)
                
            sequences.append({
                &#39;equation&#39;: sequence.get(&#39;equation&#39;, &#39;&#39;),
                &#39;answer&#39;: answer,
                &#39;length&#39;: sequence.get(&#39;length&#39;, QUIZ_VALIDATION[&#34;TIME_LIMIT_DEFAULT_MATH&#34;])
            })
            
    return {
        &#34;sequences&#34;: sequences
    }</code></pre>
</details>
<div class="desc"><p>Process and normalize the math equations and answers.</p>
<p>Processes each sequence to ensure:</p>
<ul>
<li>All answers are properly formatted numbers</li>
<li>Each sequence has a time limit</li>
<li>Equations are properly formatted</li>
</ul>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>question_data</code></strong></dt>
<dd>Raw question data from frontend</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Dict</code></dt>
<dd>Dictionary with normalized math sequences</dd>
</dl></div>
</dd>
<dt id="app.services.question_handlers.math_quiz_handler.MathQuizQuestionHandler.create_question_dict"><code class="name flex">
<span>def <span class="ident">create_question_dict</span></span>(<span>self,<br>question_data: Dict[str, Any],<br>quiz_id: bson.objectid.ObjectId,<br>device_id: str,<br>original: Dict[str, Any] | None = None) ‑> Dict[str, Any]</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def create_question_dict(self, question_data: Dict[str, Any], quiz_id: ObjectId, 
                       device_id: str, original: Optional[Dict[str, Any]] = None) -&gt; Dict[str, Any]:
    &#34;&#34;&#34;
    Create a database document for a math quiz question.
    
    Adapts the base question structure for math quiz specifics:
    
    - Doesn&#39;t require standard question text
    - Stores sequences of equations
    - Handles metadata appropriately
    
    Args:
        question_data: Raw question data from frontend
        quiz_id: MongoDB ObjectId of the parent quiz
        device_id: Device identifier of the creator/editor
        original: Original question document if this is an update
        
    Returns:
        Dict: Processed math quiz question ready for database storage
    &#34;&#34;&#34;
    if not question_data:
        question_data = {&#39;sequences&#39;: []}
    
    is_modified = question_data.get(&#34;modified&#34;, False)
    is_existing = original is not None
    
    question_dict = {
        &#34;type&#34;: self.question_type,
        &#34;part_of&#34;: quiz_id,
        &#34;created_by&#34;: device_id,
        &#34;copy_of&#34;: self._determine_copy_of(question_data, original, is_modified, is_existing),
        &#34;metadata&#34;: QuestionMetadata().to_dict()
    }
    
    # Add type-specific fields
    question_dict.update(self.add_type_specific_fields(question_data))
    
    return question_dict</code></pre>
</details>
<div class="desc"><p>Create a database document for a math quiz question.</p>
<p>Adapts the base question structure for math quiz specifics:</p>
<ul>
<li>Doesn't require standard question text</li>
<li>Stores sequences of equations</li>
<li>Handles metadata appropriately</li>
</ul>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>question_data</code></strong></dt>
<dd>Raw question data from frontend</dd>
<dt><strong><code>quiz_id</code></strong></dt>
<dd>MongoDB ObjectId of the parent quiz</dd>
<dt><strong><code>device_id</code></strong></dt>
<dd>Device identifier of the creator/editor</dd>
<dt><strong><code>original</code></strong></dt>
<dd>Original question document if this is an update</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Dict</code></dt>
<dd>Processed math quiz question ready for database storage</dd>
</dl></div>
</dd>
<dt id="app.services.question_handlers.math_quiz_handler.MathQuizQuestionHandler.format_for_frontend"><code class="name flex">
<span>def <span class="ident">format_for_frontend</span></span>(<span>self, question: Dict[str, Any], quiz_name: str = 'Unknown Quiz') ‑> Dict[str, Any]</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def format_for_frontend(self, question: Dict[str, Any], quiz_name: str = &#34;Unknown Quiz&#34;) -&gt; Dict[str, Any]:
    &#34;&#34;&#34;
    Format math quiz question for frontend display.
    
    Creates a display-friendly version of the math quiz with:

    - Default title for math questions
    - Formatted sequence data
    - Human-readable answer display
    
    Args:
        question: Database question document
        quiz_name: Name of the parent quiz
        
    Returns:
        Dict: Formatted math quiz question for frontend display
    &#34;&#34;&#34;
    # Safety check to avoid NoneType errors
    if not question:
        return {
            &#39;_id&#39;: &#39;&#39;,
            &#39;question&#39;: &#39;Matematické rovnice&#39;,
            &#39;type&#39;: self.question_type,
            &#39;category&#39;: &#39;&#39;,
            &#39;length&#39;: &#39;&#39;,
            &#39;timeLimit&#39;: &#39;&#39;,
            &#39;quizName&#39;: quiz_name,
            &#39;timesPlayed&#39;: 0,
            &#39;copy_of&#39;: None,
            &#39;isMyQuestion&#39;: False,
            &#39;sequences&#39;: [],
            &#39;answers&#39;: [{&#39;text&#39;: &#39;No equations defined&#39;, &#39;isCorrect&#39;: True}]
        }
    
    # Customize the base implementation for math quiz questions that don&#39;t have a question field
    question_data = {
        &#39;_id&#39;: str(question.get(&#39;_id&#39;, &#39;&#39;)),
        &#39;question&#39;: &#39;Matematické rovnice&#39;,  # Default title for math sequences
        &#39;type&#39;: question.get(&#39;type&#39;, self.question_type),
        &#39;category&#39;: question.get(&#39;category&#39;, &#39;&#39;),
        &#39;length&#39;: question.get(&#39;length&#39;, &#39;&#39;),
        &#39;timeLimit&#39;: question.get(&#39;length&#39;, &#39;&#39;),
        &#39;quizName&#39;: quiz_name,
        &#39;timesPlayed&#39;: question.get(&#39;metadata&#39;, {}).get(&#39;timesUsed&#39;, 0) if question.get(&#39;metadata&#39;) else 0,
        &#39;copy_of&#39;: str(question[&#39;copy_of&#39;]) if question.get(&#39;copy_of&#39;) else None,
        &#39;isMyQuestion&#39;: False
    }
    
    sequences = question.get(&#39;sequences&#39;, [])
    # Ensure sequences is always a list
    if not isinstance(sequences, list):
        sequences = []
        
    question_data[&#39;sequences&#39;] = sequences
    
    # Format for display in the game
    # Create answers for display in existing questions dialog
    answers = []
    for sequence in sequences:
        if not sequence or not isinstance(sequence, dict):
            continue
            
        answers.append({
            &#39;text&#39;: f&#34;{sequence.get(&#39;equation&#39;, &#39;&#39;)} = {sequence.get(&#39;answer&#39;, &#39;&#39;)} ({sequence.get(&#39;length&#39;, QUIZ_VALIDATION[&#39;TIME_LIMIT_DEFAULT_MATH&#39;])}s)&#34;,
            &#39;isCorrect&#39;: True
        })
        
    if not answers:
        answers = [{&#39;text&#39;: &#39;No equations defined&#39;, &#39;isCorrect&#39;: True}]
        
    question_data[&#39;answers&#39;] = answers
        
    return question_data</code></pre>
</details>
<div class="desc"><p>Format math quiz question for frontend display.</p>
<p>Creates a display-friendly version of the math quiz with:</p>
<ul>
<li>Default title for math questions</li>
<li>Formatted sequence data</li>
<li>Human-readable answer display</li>
</ul>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>question</code></strong></dt>
<dd>Database question document</dd>
<dt><strong><code>quiz_name</code></strong></dt>
<dd>Name of the parent quiz</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Dict</code></dt>
<dd>Formatted math quiz question for frontend display</dd>
</dl></div>
</dd>
<dt id="app.services.question_handlers.math_quiz_handler.MathQuizQuestionHandler.validate"><code class="name flex">
<span>def <span class="ident">validate</span></span>(<span>self, question_data: Dict[str, Any]) ‑> bool</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def validate(self, question_data: Dict[str, Any]) -&gt; bool:
    &#34;&#34;&#34;
    Validate that the math quiz question data is valid.
    
    Checks that:

    - The question contains sequences of equations
    - Each sequence has both an equation and a numeric answer
    - All answers are valid numbers
    
    Args:
        question_data: Raw question data to validate
        
    Returns:
        bool: True if the math quiz data is valid
    &#34;&#34;&#34;
    # Override base validation to skip question validation
    # Only verify type is correct
    if not question_data or question_data.get(&#39;type&#39;) != self.question_type:
        return False
    
    # Math Quiz specific validation
    sequences = question_data.get(&#39;sequences&#39;, [])
    
    # Check if sequences are present
    if not sequences or not isinstance(sequences, list):
        return False
        
    # Check if each sequence has valid equations and answers
    for sequence in sequences:
        if not sequence or not isinstance(sequence, dict):
            return False
            
        equation = sequence.get(&#39;equation&#39;)
        answer = sequence.get(&#39;answer&#39;)
        
        # Both equation and answer must be present
        if not equation or answer is None:
            return False
            
        # Answer must be a number (int or float)
        if not isinstance(answer, (int, float)) and not (
            isinstance(answer, str) and self._is_valid_number(answer)
        ):
            return False
            
    return True</code></pre>
</details>
<div class="desc"><p>Validate that the math quiz question data is valid.</p>
<p>Checks that:</p>
<ul>
<li>The question contains sequences of equations</li>
<li>Each sequence has both an equation and a numeric answer</li>
<li>All answers are valid numbers</li>
</ul>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>question_data</code></strong></dt>
<dd>Raw question data to validate</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>bool</code></dt>
<dd>True if the math quiz data is valid</dd>
</dl></div>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="app.services.question_handlers.base_handler.BaseQuestionHandler" href="base_handler.html#app.services.question_handlers.base_handler.BaseQuestionHandler">BaseQuestionHandler</a></b></code>:
<ul class="hlist">
<li><code><a title="app.services.question_handlers.base_handler.BaseQuestionHandler.handle_copy_references" href="base_handler.html#app.services.question_handlers.base_handler.BaseQuestionHandler.handle_copy_references">handle_copy_references</a></code></li>
</ul>
</li>
</ul>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="app.services.question_handlers" href="index.html">app.services.question_handlers</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="app.services.question_handlers.math_quiz_handler.MathQuizQuestionHandler" href="#app.services.question_handlers.math_quiz_handler.MathQuizQuestionHandler">MathQuizQuestionHandler</a></code></h4>
<ul class="">
<li><code><a title="app.services.question_handlers.math_quiz_handler.MathQuizQuestionHandler.add_type_specific_fields" href="#app.services.question_handlers.math_quiz_handler.MathQuizQuestionHandler.add_type_specific_fields">add_type_specific_fields</a></code></li>
<li><code><a title="app.services.question_handlers.math_quiz_handler.MathQuizQuestionHandler.create_question_dict" href="#app.services.question_handlers.math_quiz_handler.MathQuizQuestionHandler.create_question_dict">create_question_dict</a></code></li>
<li><code><a title="app.services.question_handlers.math_quiz_handler.MathQuizQuestionHandler.format_for_frontend" href="#app.services.question_handlers.math_quiz_handler.MathQuizQuestionHandler.format_for_frontend">format_for_frontend</a></code></li>
<li><code><a title="app.services.question_handlers.math_quiz_handler.MathQuizQuestionHandler.validate" href="#app.services.question_handlers.math_quiz_handler.MathQuizQuestionHandler.validate">validate</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>
</body>
</html>
