<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
<meta name="generator" content="pdoc3 0.11.6">
<title>app.routes.media_routes API documentation</title>
<meta name="description" content="Media handling routes for the quiz application (for Open Answer question type).
Provides endpoints for uploading to and deleting from Cloudinary.
…">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/sanitize.min.css" integrity="sha512-y1dtMcuvtTMJc1yPgEqF0ZjQbhnc/bFhyvIyVNb9Zk5mIGtqVaAB1Ttl28su8AvFMOY0EwRbAe+HCLqj6W7/KA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/typography.min.css" integrity="sha512-Y1DYSb995BAfxobCkKepB1BqJJTPrOp3zPL74AWFugHHmmdcvO+C48WLrUOlhGMc0QG7AE3f7gmvvcrmX2fDoA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:1.5em;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:2em 0 .50em 0}h3{font-size:1.4em;margin:1.6em 0 .7em 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .2s ease-in-out}a:visited{color:#503}a:hover{color:#b62}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900;font-weight:bold}pre code{font-size:.8em;line-height:1.4em;padding:1em;display:block}code{background:#f3f3f3;font-family:"DejaVu Sans Mono",monospace;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source > summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible;min-width:max-content}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em 1em;margin:1em 0}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul ul{padding-left:1em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" integrity="sha512-D9gUyxqja7hBtkWpPWGt9wfbfaMGVt9gnyCvYa+jojwwPHLCzUm5i8rpk7vD7wNee9bA35eYIjobYPaQuKS1MQ==" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => {
hljs.configure({languages: ['bash', 'css', 'diff', 'graphql', 'ini', 'javascript', 'json', 'plaintext', 'python', 'python-repl', 'rust', 'shell', 'sql', 'typescript', 'xml', 'yaml']});
hljs.highlightAll();
/* Collapse source docstrings */
setTimeout(() => {
[...document.querySelectorAll('.hljs.language-python > .hljs-string')]
.filter(el => el.innerHTML.length > 200 && ['"""', "'''"].includes(el.innerHTML.substring(0, 3)))
.forEach(el => {
let d = document.createElement('details');
d.classList.add('hljs-string');
d.innerHTML = '<summary>"""</summary>' + el.innerHTML.substring(3);
el.replaceWith(d);
});
}, 100);
})</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>app.routes.media_routes</code></h1>
</header>
<section id="section-intro">
<p>Media handling routes for the quiz application (for Open Answer question type).
Provides endpoints for uploading to and deleting from Cloudinary.
Supports different media types with appropriate optimizations.</p>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="app.routes.media_routes.delete_media"><code class="name flex">
<span>def <span class="ident">delete_media</span></span>(<span>)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@media_routes.route(&#39;/delete_media&#39;, methods=[&#39;POST&#39;])
def delete_media():
    &#34;&#34;&#34;
    Delete a media file from Cloudinary.
    
    Request body (JSON):
    
        url: The URL of the file to delete
    
    Returns:
        200 JSON: Confirmation message if deletion succeeds
        400 JSON: Error if URL is missing
        500 JSON: Error if deletion fails
    &#34;&#34;&#34;
    data = request.json
    url = data.get(&#39;url&#39;)
    
    if not url:
        return jsonify({&#34;error&#34;: &#34;Žádné URL nebylo poskytnuto&#34;}), 400
        
    try:
        success = CloudinaryService.delete_file(url)

        if success:
            return jsonify({&#34;message&#34;: &#34;File deleted successfully&#34;}), 200
        
        return jsonify({&#34;error&#34;: &#34;Smazání souboru selhalo&#34;}), 500
    
    except Exception as e:
        return jsonify({&#34;error&#34;: str(e)}), 500</code></pre>
</details>
<div class="desc"><p>Delete a media file from Cloudinary.</p>
<p>Request body (JSON):</p>
<pre><code>url: The URL of the file to delete
</code></pre>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>200 JSON</code></dt>
<dd>Confirmation message if deletion succeeds</dd>
<dt><code>400 JSON</code></dt>
<dd>Error if URL is missing</dd>
<dt><code>500 JSON</code></dt>
<dd>Error if deletion fails</dd>
</dl></div>
</dd>
<dt id="app.routes.media_routes.upload_media"><code class="name flex">
<span>def <span class="ident">upload_media</span></span>(<span>)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@media_routes.route(&#39;/upload_media&#39;, methods=[&#39;POST&#39;])
def upload_media():
    &#34;&#34;&#34;
    Upload media files to Cloudinary and return the URL.
    
    Handles both image and audio file uploads with appropriate optimizations.
    Images are optimized with auto quality and format.
    Audio files are stored in a separate folder.
    
    Request body:

        file: The media file to upload (multipart/form-data)
    
    Returns:
        200 JSON: 
        
            - url: URL to access the uploaded file
            - public_id: Cloudinary public ID
            - resource_type: Type of resource (image/video)
            - format: File format
        400 JSON: Error if file is missing
        500 JSON: Error if upload fails
    &#34;&#34;&#34;
    if &#39;file&#39; not in request.files:
        return jsonify({&#34;error&#34;: &#34;Žádný soubor nebyl vybrán&#34;}), 400
        
    file = request.files[&#39;file&#39;]
    
    if file.filename == &#39;&#39;:
        return jsonify({&#34;error&#34;: &#34;Žádný soubor nebyl vybrán&#34;}), 400
    
    try:
        # Determine if it&#39;s image or audio based on mimetype
        mimetype = file.mimetype
        resource_type = &#34;auto&#34;
        folder = &#34;quiz_media&#34;
        transformation = None
        
        # Prepare optimized transformations based on file type
        if mimetype.startswith(&#39;image/&#39;):
            resource_type = &#34;image&#34;
            # Set automatic quality and format optimization for images
            transformation = {&#34;quality&#34;: &#34;auto&#34;, &#34;fetch_format&#34;: &#34;auto&#34;}
        elif mimetype.startswith(&#39;audio/&#39;):
            resource_type = &#34;video&#34;  # Cloudinary uses &#34;video&#34; type for audio too
            folder = &#34;quiz_audio&#34;
        
        # Upload to Cloudinary
        result = CloudinaryService.upload_file(
            file,
            folder=folder,
            resource_type=resource_type,
            transformation=transformation
        )
        
        # Return the secure URL and other needed metadata
        return jsonify({
            &#34;url&#34;: result[&#34;secure_url&#34;],
            &#34;public_id&#34;: result[&#34;public_id&#34;],
            &#34;resource_type&#34;: resource_type,
            &#34;format&#34;: result[&#34;format&#34;]
        })
    
    except Exception as e:
        return jsonify({&#34;error&#34;: str(e)}), 500</code></pre>
</details>
<div class="desc"><p>Upload media files to Cloudinary and return the URL.</p>
<p>Handles both image and audio file uploads with appropriate optimizations.
Images are optimized with auto quality and format.
Audio files are stored in a separate folder.</p>
<p>Request body:</p>
<pre><code>file: The media file to upload (multipart/form-data)
</code></pre>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>200 JSON</code></dt>
<dd>
<ul>
<li>url: URL to access the uploaded file</li>
<li>public_id: Cloudinary public ID</li>
<li>resource_type: Type of resource (image/video)</li>
<li>format: File format</li>
</ul>
</dd>
<dt><code>400 JSON</code></dt>
<dd>Error if file is missing</dd>
<dt><code>500 JSON</code></dt>
<dd>Error if upload fails</dd>
</dl></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="app.routes" href="index.html">app.routes</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="app.routes.media_routes.delete_media" href="#app.routes.media_routes.delete_media">delete_media</a></code></li>
<li><code><a title="app.routes.media_routes.upload_media" href="#app.routes.media_routes.upload_media">upload_media</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>
</body>
</html>
